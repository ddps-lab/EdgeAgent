# EdgeAgent Tool Configuration - Scenario 02: Log Analysis Pipeline
#
# Score-based Scheduling:
#   Cost_i(u, v) = α * (P_exec[i][u] + β * P_net[u]) + (1-α) * P_comm[(v,u)]
#
#   - α (alpha): 연산 중요도 (0~1), 높을수록 연산 비용 중시
#   - β: data_locality == external_data일 때 자동으로 1 (scoring.py에서 처리)
#   - P_exec: Tool별 노드 연산 비용 [D, E, C] (0.0=빠름, 1.0=느림)
#   - P_net, P_comm: system.yaml에서 정의
#
# Data Locality Types:
#   - args_only (Type A): 데이터가 args로 전달됨 → Score 기반 노드 선택
#   - external_data (Type B): 외부 API 접근 → β=1 자동 적용
#   - local_data (Type C): 로컬 파일 접근 → 경로 기반 노드 결정 (Score 무시)

tools:
  # ============================================================
  # filesystem server tools
  # ============================================================
  filesystem:
    endpoints:
      DEVICE:
        transport: stdio
        command: mcp-server-filesystem
        args:
          - "/edgeagent"
        env: {}
      EDGE:
        transport: streamable_http
        url: "http://mcp-filesystem.edgeagent.edge.edgeagent.ddps.cloud"
      CLOUD:
        transport: streamable_http
        url: "http://mcp-filesystem.edgeagent.cloud.edgeagent.ddps.cloud/mcp"

    tool_profiles:
      # 파일 읽기: path 인자로 로컬 파일 경로 지정
      read_file:
        description: "Read file contents from filesystem"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 파일 쓰기: path 인자로 로컬 파일 경로 지정
      write_file:
        description: "Write content to a file"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 다중 파일 읽기: paths 인자로 로컬 파일 경로들 지정
      read_multiple_files:
        description: "Read multiple files at once"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 디렉토리 목록: path 인자로 로컬 디렉토리 경로 지정
      list_directory:
        description: "List directory contents"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 디렉토리 목록(크기 포함): path 인자로 로컬 디렉토리 경로 지정
      list_directory_with_sizes:
        description: "List directory with file sizes"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 디렉토리 트리: path 인자로 로컬 디렉토리 경로 지정
      directory_tree:
        description: "Get directory tree structure"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 파일 검색: path 인자로 검색 시작 경로 지정
      search_files:
        description: "Search for files by pattern"
        data_locality: local_data
        alpha: 0.5
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 파일 정보: path 인자로 로컬 파일 경로 지정
      get_file_info:
        description: "Get file metadata"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 디렉토리 생성: path 인자로 생성할 로컬 경로 지정
      create_directory:
        description: "Create a new directory"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 파일 이동: source/destination 인자로 로컬 경로 지정
      move_file:
        description: "Move or rename a file"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 파일 편집: path 인자로 로컬 파일 경로 지정
      edit_file:
        description: "Edit file contents"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 텍스트 파일 읽기: path 인자로 로컬 파일 경로 지정
      read_text_file:
        description: "Read text file contents"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 미디어 파일 읽기: path 인자로 로컬 파일 경로 지정
      read_media_file:
        description: "Read media file as base64"
        data_locality: local_data
        alpha: 0.2
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: true

      # 허용 디렉토리 목록: 서버 설정 정보 반환, 인자 없음
      list_allowed_directories:
        description: "List allowed directories for access"
        data_locality: args_only
        alpha: 0.1
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false

  # ============================================================
  # log_parser server tools
  # ------------------------------------------------------------
  # Type A (args_only): 로그 데이터가 args로 직접 전달됨
  # - log_content, entries 등이 args로 전달되어 어느 노드에서든 실행 가능
  # - compute intensity로 실행 노드 결정
  # - requires_cloud_api: false (외부 API 호출 없음)
  # - privacy_sensitive: false (로그 데이터는 이미 읽혀서 전달됨)
  # ============================================================
  log_parser:
    endpoints:
      DEVICE:
        transport: stdio
        command: python
        args:
          - "servers/log_parser_server.py"
        env: {}
      EDGE:
        transport: streamable_http
        url: "http://mcp-log-parser.edgeagent.edge.edgeagent.ddps.cloud"
      CLOUD:
        transport: streamable_http
        url: "http://mcp-log-parser.edgeagent.cloud.edgeagent.ddps.cloud/mcp"

    tool_profiles:
      # 로그 파싱: log_content 인자로 로그 텍스트 직접 전달 → args_only
      parse_logs:
        description: "Parse log file and extract structured data"
        data_locality: args_only
        alpha: 0.6
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false

      # 엔트리 필터링: entries 인자로 파싱된 로그 직접 전달 → args_only
      filter_entries:
        description: "Filter log entries by severity level (min_level)"
        data_locality: args_only
        alpha: 0.4
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false

      # 통계 계산: entries 인자로 파싱된 로그 직접 전달 → args_only
      compute_log_statistics:
        description: "Compute statistics from log data"
        data_locality: args_only
        alpha: 0.6
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false

      # 엔트리 검색: entries 인자로 파싱된 로그 직접 전달 → args_only
      search_entries:
        description: "Search log entries by regex pattern"
        data_locality: args_only
        alpha: 0.5
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false

  # ============================================================
  # data_aggregate server tools
  # ============================================================
  data_aggregate:
    endpoints:
      DEVICE:
        transport: stdio
        command: python
        args:
          - "servers/data_aggregate_server.py"
        env: {}
      EDGE:
        transport: streamable_http
        url: "http://mcp-data-aggregate.edgeagent.edge.edgeagent.ddps.cloud"
      CLOUD:
        transport: streamable_http
        url: "http://mcp-data-aggregate.edgeagent.cloud.edgeagent.ddps.cloud/mcp"

    tool_profiles:
      # 리스트 집계: items 인자로 데이터 직접 전달
      aggregate_list:
        description: "Aggregate list of items by grouping/counting/summing"
        data_locality: args_only
        alpha: 0.5
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false

      # 요약 병합: summaries 인자로 데이터 직접 전달
      merge_summaries:
        description: "Merge multiple summary dictionaries"
        data_locality: args_only
        alpha: 0.5
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false

      # 연구결과 결합: results 인자로 데이터 직접 전달
      combine_research_results:
        description: "Combine research/search results into summary"
        data_locality: args_only
        alpha: 0.5
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false

      # 중복 제거: items 인자로 데이터 직접 전달 
      deduplicate:
        description: "Remove duplicate items based on key fields"
        data_locality: args_only
        alpha: 0.5
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false

      # 트렌드 계산: time_series 인자로 데이터 직접 전달
      compute_trends:
        description: "Compute trends from time-series data"
        data_locality: args_only
        alpha: 0.6
        P_exec: [1.0, 0.3, 0.0]
        requires_cloud_api: false
        privacy_sensitive: false


# Static mapping (StaticScheduler용) - MCP Server 이름으로 location 지정
static_mapping:
  filesystem: DEVICE
  log_parser: EDGE
  data_aggregate: EDGE
